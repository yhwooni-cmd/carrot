<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>íšŒì›ê°€ì… - ì•ˆì „í•œ ì¤‘ê³ ê±°ë˜ í”Œë«í¼</title>
    <link rel="stylesheet" href="common.css">
    <style>
        /* íšŒì›ê°€ì… ì „ìš© ìŠ¤íƒ€ì¼ */
        .signup-container {
            max-width: 600px;
            margin: 0 auto;
            padding: var(--space-lg);
        }

        .signup-header {
            text-align: center;
            margin-bottom: var(--space-2xl);
        }

        .signup-title {
            font-size: var(--font-size-h2);
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: var(--space-sm);
        }

        .signup-subtitle {
            font-size: var(--font-size-body);
            color: var(--text-secondary);
        }

        .step-content {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        .step-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .signup-form {
            background: var(--surface);
            border-radius: 16px;
            padding: var(--space-2xl);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            margin-bottom: var(--space-lg);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-md);
        }

        .form-row .form-group {
            margin-bottom: var(--space-md);
        }

        .password-strength {
            margin-top: var(--space-sm);
            padding: var(--space-sm);
            border-radius: 8px;
            background: #F5F5F5;
            font-size: var(--font-size-caption);
        }

        .strength-weak {
            background: #FFEBEE;
            color: var(--error);
        }

        .strength-medium {
            background: #FFF8E1;
            color: var(--warning);
        }

        .strength-strong {
            background: #E8F5E8;
            color: var(--success);
        }

        .verification-section {
            background: #F8F9FA;
            border-radius: 12px;
            padding: var(--space-lg);
            margin: var(--space-md) 0;
        }

        .verification-input {
            display: flex;
            gap: var(--space-md);
            align-items: flex-end;
        }

        .verification-input .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        .timer {
            color: var(--error);
            font-weight: 500;
            font-size: var(--font-size-body-sm);
            margin-top: var(--space-xs);
        }

        .file-upload {
            border: 2px dashed var(--border);
            border-radius: 12px;
            padding: var(--space-2xl);
            text-align: center;
            background: #FAFAFA;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .file-upload:hover {
            border-color: var(--primary-blue);
            background: #F0F7FF;
        }

        .file-upload.drag-over {
            border-color: var(--primary-blue);
            background: #E3F2FD;
        }

        .upload-icon {
            font-size: 48px;
            color: var(--text-disabled);
            margin-bottom: var(--space-md);
        }

        .upload-text {
            font-size: var(--font-size-body);
            color: var(--text-secondary);
            margin-bottom: var(--space-sm);
        }

        .upload-hint {
            font-size: var(--font-size-caption);
            color: var(--text-disabled);
        }

        .safety-preview {
            background: linear-gradient(135deg, #E8F5E8 0%, #F1F8E9 100%);
            border-radius: 16px;
            padding: var(--space-lg);
            margin: var(--space-lg) 0;
            text-align: center;
        }

        .initial-score {
            font-size: var(--font-size-h1);
            font-weight: bold;
            color: var(--safety-good-primary);
            margin-bottom: var(--space-sm);
        }

        .score-description {
            font-size: var(--font-size-body-sm);
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .action-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: var(--space-2xl);
            padding-top: var(--space-lg);
            border-top: 1px solid var(--border);
        }

        .help-link {
            color: var(--primary-blue);
            text-decoration: none;
            font-size: var(--font-size-body-sm);
        }

        .help-link:hover {
            text-decoration: underline;
        }

        .terms-check {
            display: flex;
            align-items: flex-start;
            gap: var(--space-sm);
            margin: var(--space-lg) 0;
        }

        .terms-check input[type="checkbox"] {
            margin-top: 4px;
        }

        .terms-text {
            font-size: var(--font-size-body-sm);
            line-height: 1.5;
        }

        .terms-link {
            color: var(--primary-blue);
            text-decoration: underline;
        }

        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 767px) {
            .signup-container {
                padding: var(--space-md);
            }

            .signup-form {
                padding: var(--space-lg);
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .verification-input {
                flex-direction: column;
                align-items: stretch;
            }

            .action-buttons {
                flex-direction: column;
                gap: var(--space-md);
            }

            .help-link {
                order: 1;
            }
        }
    </style>
</head>
<body>
    <!-- í—¤ë” -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <a href="01-ë¡œê·¸ì¸.html" class="logo">ğŸ¥• ë‹¹ê·¼ì•ˆì „</a>
                <div class="user-menu">
                    <a href="01-ë¡œê·¸ì¸.html" class="nav-link">ë¡œê·¸ì¸</a>
                    <a href="#" class="nav-link">ë„ì›€ë§</a>
                </div>
            </div>
        </div>
    </header>

    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <main class="signup-container">
        <!-- í˜ì´ì§€ í—¤ë” -->
        <div class="signup-header">
            <h1 class="signup-title">ì•ˆì „í•œ ê±°ë˜ë¥¼ ìœ„í•œ íšŒì›ê°€ì…</h1>
            <p class="signup-subtitle">ë‹¨ê³„ë³„ ì¸ì¦ì„ í†µí•´ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ê±°ë˜ í™˜ê²½ì„ ë§Œë“¤ì–´ë³´ì„¸ìš”</p>
        </div>

        <!-- ì§„í–‰ ë‹¨ê³„ í‘œì‹œ -->
        <div class="progress-steps">
            <div class="progress-step current" data-step="1">
                <div class="progress-step__icon">1</div>
                <div class="progress-step__label">ê¸°ë³¸ì •ë³´</div>
            </div>
            <div class="progress-step" data-step="2">
                <div class="progress-step__icon">2</div>
                <div class="progress-step__label">íœ´ëŒ€í° ì¸ì¦</div>
            </div>
            <div class="progress-step" data-step="3">
                <div class="progress-step__icon">3</div>
                <div class="progress-step__label">ì´ë©”ì¼ ì¸ì¦</div>
            </div>
            <div class="progress-step" data-step="4">
                <div class="progress-step__icon">4</div>
                <div class="progress-step__label">ì‹ ë¶„ì¦ ì¸ì¦</div>
            </div>
        </div>

        <!-- 1ë‹¨ê³„: ê¸°ë³¸ì •ë³´ ì…ë ¥ -->
        <div class="step-content active" id="step-1">
            <form class="signup-form" id="basic-info-form">
                <h3 class="card__title">ê¸°ë³¸ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</h3>
                <p class="card__subtitle mb-3">ì•ˆì „í•œ ê±°ë˜ë¥¼ ìœ„í•´ ì •í™•í•œ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</p>

                <div class="form-group">
                    <label for="email" class="form-label">ì´ë©”ì¼ ì£¼ì†Œ *</label>
                    <input type="email" id="email" class="form-input" data-validate="email" placeholder="example@email.com" required>
                    <span class="form-error"></span>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="password" class="form-label">ë¹„ë°€ë²ˆí˜¸ *</label>
                        <input type="password" id="password" class="form-input" data-validate="password" placeholder="8ì ì´ìƒ, ì˜ë¬¸+ìˆ«ì" required>
                        <div class="password-strength" id="password-strength">
                            ë¹„ë°€ë²ˆí˜¸ ê°•ë„: <span id="strength-text">ì•½í•¨</span>
                        </div>
                        <span class="form-error"></span>
                    </div>
                    <div class="form-group">
                        <label for="password-confirm" class="form-label">ë¹„ë°€ë²ˆí˜¸ í™•ì¸ *</label>
                        <input type="password" id="password-confirm" class="form-input" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ì…ë ¥" required>
                        <span class="form-error"></span>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="name" class="form-label">ì´ë¦„ *</label>
                        <input type="text" id="name" class="form-input" placeholder="ì‹¤ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”" required>
                        <span class="form-error"></span>
                    </div>
                    <div class="form-group">
                        <label for="phone" class="form-label">íœ´ëŒ€í° ë²ˆí˜¸ *</label>
                        <input type="tel" id="phone" class="form-input" data-validate="phone" placeholder="010-1234-5678" required>
                        <span class="form-error"></span>
                    </div>
                </div>

                <div class="terms-check">
                    <input type="checkbox" id="terms-agree" required>
                    <label for="terms-agree" class="terms-text">
                        <a href="#" class="terms-link">ì´ìš©ì•½ê´€</a> ë°
                        <a href="#" class="terms-link">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a>ì— ë™ì˜í•©ë‹ˆë‹¤ *
                    </label>
                </div>

                <div class="terms-check">
                    <input type="checkbox" id="marketing-agree">
                    <label for="marketing-agree" class="terms-text">
                        ë§ˆì¼€íŒ… ìˆ˜ì‹ ì— ë™ì˜í•©ë‹ˆë‹¤ (ì„ íƒ)
                    </label>
                </div>
            </form>
        </div>

        <!-- 2ë‹¨ê³„: íœ´ëŒ€í° ì¸ì¦ -->
        <div class="step-content" id="step-2">
            <div class="signup-form">
                <h3 class="card__title">íœ´ëŒ€í° ì¸ì¦</h3>
                <p class="card__subtitle mb-3">ì•ˆì „í•œ ê±°ë˜ë¥¼ ìœ„í•´ íœ´ëŒ€í° ë²ˆí˜¸ë¥¼ ì¸ì¦í•´ì£¼ì„¸ìš”</p>

                <div class="verification-section">
                    <div class="alert alert--info">
                        <div class="alert__icon">ğŸ“±</div>
                        <div class="alert__content">
                            <div class="alert__title">íœ´ëŒ€í° ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤</div>
                            <div class="alert__message">ì…ë ¥í•˜ì‹  íœ´ëŒ€í° ë²ˆí˜¸ <strong id="phone-display"></strong>ë¡œ ì¸ì¦ë²ˆí˜¸ë¥¼ ë°œì†¡í•©ë‹ˆë‹¤.</div>
                        </div>
                    </div>

                    <div class="verification-input">
                        <div class="form-group">
                            <label for="sms-code" class="form-label">ì¸ì¦ë²ˆí˜¸</label>
                            <input type="text" id="sms-code" class="form-input" placeholder="6ìë¦¬ ì¸ì¦ë²ˆí˜¸ ì…ë ¥" maxlength="6">
                            <div class="timer" id="sms-timer">ì¸ì¦ë²ˆí˜¸ ìš”ì²­ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”</div>
                        </div>
                        <button type="button" class="btn btn--secondary" id="send-sms-btn" data-loading="true">ì¸ì¦ë²ˆí˜¸ ë°œì†¡</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 3ë‹¨ê³„: ì´ë©”ì¼ ì¸ì¦ -->
        <div class="step-content" id="step-3">
            <div class="signup-form">
                <h3 class="card__title">ì´ë©”ì¼ ì¸ì¦</h3>
                <p class="card__subtitle mb-3">ê³„ì • ë³´ì•ˆì„ ìœ„í•´ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì¸ì¦í•´ì£¼ì„¸ìš”</p>

                <div class="verification-section">
                    <div class="alert alert--info">
                        <div class="alert__icon">ğŸ“§</div>
                        <div class="alert__content">
                            <div class="alert__title">ì´ë©”ì¼ ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤</div>
                            <div class="alert__message">ì…ë ¥í•˜ì‹  ì´ë©”ì¼ ì£¼ì†Œ <strong id="email-display"></strong>ë¡œ ì¸ì¦ë²ˆí˜¸ë¥¼ ë°œì†¡í•©ë‹ˆë‹¤.</div>
                        </div>
                    </div>

                    <div class="verification-input">
                        <div class="form-group">
                            <label for="email-code" class="form-label">ì¸ì¦ë²ˆí˜¸</label>
                            <input type="text" id="email-code" class="form-input" placeholder="6ìë¦¬ ì¸ì¦ë²ˆí˜¸ ì…ë ¥" maxlength="6">
                            <div class="timer" id="email-timer">ì¸ì¦ë²ˆí˜¸ ìš”ì²­ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”</div>
                        </div>
                        <button type="button" class="btn btn--secondary" id="send-email-btn" data-loading="true">ì¸ì¦ë²ˆí˜¸ ë°œì†¡</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 4ë‹¨ê³„: ì‹ ë¶„ì¦ ì¸ì¦ (ì„ íƒ) -->
        <div class="step-content" id="step-4">
            <div class="signup-form">
                <h3 class="card__title">ì‹ ë¶„ì¦ ì¸ì¦ (ì„ íƒì‚¬í•­)</h3>
                <p class="card__subtitle mb-3">ë” ë†’ì€ ì•ˆì „ë„ë¥¼ ì›í•˜ì‹œë©´ ì‹ ë¶„ì¦ ì¸ì¦ì„ ì§„í–‰í•´ì£¼ì„¸ìš”</p>

                <div class="alert alert--info">
                    <div class="alert__icon">â„¹ï¸</div>
                    <div class="alert__content">
                        <div class="alert__title">ì„ íƒì‚¬í•­ì…ë‹ˆë‹¤</div>
                        <div class="alert__message">ì‹ ë¶„ì¦ ì¸ì¦ ì‹œ ì•ˆì „ë„ê°€ +15ì  ìƒìŠ¹í•©ë‹ˆë‹¤. ë‚˜ì¤‘ì—ë„ ì¸ì¦í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
                    </div>
                </div>

                <div class="file-upload" id="id-upload">
                    <div class="upload-icon">ğŸ†”</div>
                    <div class="upload-text">ì‹ ë¶„ì¦ ì‚¬ì§„ì„ ì—…ë¡œë“œí•˜ì„¸ìš”</div>
                    <div class="upload-hint">
                        â€¢ ì£¼ë¯¼ë“±ë¡ì¦, ìš´ì „ë©´í—ˆì¦, ì—¬ê¶Œ ì¤‘ í•˜ë‚˜<br>
                        â€¢ ê°œì¸ì •ë³´ëŠ” ìë™ìœ¼ë¡œ ë§ˆìŠ¤í‚¹ë©ë‹ˆë‹¤<br>
                        â€¢ íŒŒì¼ í¬ê¸°: ìµœëŒ€ 10MB
                    </div>
                    <input type="file" id="id-file" accept="image/*" style="display: none;">
                </div>

                <div id="id-preview" style="display: none;">
                    <div class="alert alert--success">
                        <div class="alert__icon">âœ…</div>
                        <div class="alert__content">
                            <div class="alert__title">ì—…ë¡œë“œ ì™„ë£Œ</div>
                            <div class="alert__message">ì‹ ë¶„ì¦ì´ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤. ê²€í†  í›„ ì¸ì¦ì´ ì™„ë£Œë©ë‹ˆë‹¤.</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ì•ˆì „ë„ ì ìˆ˜ ë¯¸ë¦¬ë³´ê¸° -->
            <div class="safety-preview">
                <h4 class="card__title">ì˜ˆìƒ ì•ˆì „ë„ ì ìˆ˜</h4>
                <div class="initial-score" id="predicted-score">70</div>
                <div class="score-description">
                    ê¸°ë³¸ ì¸ì¦ ì™„ë£Œë¡œ <strong>ìš°ìˆ˜ ë“±ê¸‰</strong>ìœ¼ë¡œ ì‹œì‘í•©ë‹ˆë‹¤.<br>
                    ì‹ ë¶„ì¦ ì¸ì¦ ì‹œ <strong>85ì  (ìš°ìˆ˜ ë“±ê¸‰)</strong>ì´ ë©ë‹ˆë‹¤.
                </div>
            </div>
        </div>

        <!-- í•˜ë‹¨ ì•¡ì…˜ ë²„íŠ¼ -->
        <div class="action-buttons">
            <a href="#" class="help-link" id="help-link">ë„ì›€ì´ í•„ìš”í•˜ì‹ ê°€ìš”?</a>
            <div class="d-flex gap-2">
                <button type="button" class="btn btn--secondary" id="prev-btn" style="display: none;">ì´ì „</button>
                <button type="button" class="btn btn--primary" id="next-btn">ë‹¤ìŒ</button>
            </div>
        </div>
    </main>

    <!-- JavaScript -->
    <script src="common.js"></script>
    <script>
        // íšŒì›ê°€ì… ê´€ë¦¬ ê°ì²´
        const SignupManager = {
            currentStep: 1,
            maxStep: 4,
            formData: {},
            verificationStatus: {
                sms: false,
                email: false,
                idCard: false
            },

            // ì´ˆê¸°í™”
            init() {
                this.bindEvents();
                this.updateStepDisplay();
            },

            // ì´ë²¤íŠ¸ ë°”ì¸ë”©
            bindEvents() {
                // ë‹¤ìŒ/ì´ì „ ë²„íŠ¼
                document.getElementById('next-btn').addEventListener('click', () => this.nextStep());
                document.getElementById('prev-btn').addEventListener('click', () => this.prevStep());

                // SMS ì¸ì¦
                document.getElementById('send-sms-btn').addEventListener('click', () => this.sendSmsCode());
                document.getElementById('sms-code').addEventListener('input', () => this.validateSmsCode());

                // ì´ë©”ì¼ ì¸ì¦
                document.getElementById('send-email-btn').addEventListener('click', () => this.sendEmailCode());
                document.getElementById('email-code').addEventListener('input', () => this.validateEmailCode());

                // ì‹ ë¶„ì¦ ì—…ë¡œë“œ
                document.getElementById('id-upload').addEventListener('click', () => document.getElementById('id-file').click());
                document.getElementById('id-file').addEventListener('change', (e) => this.handleIdUpload(e));

                // ë“œë˜ê·¸ ì•¤ ë“œë¡­
                const uploadArea = document.getElementById('id-upload');
                ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                    uploadArea.addEventListener(eventName, (e) => e.preventDefault());
                });

                uploadArea.addEventListener('dragenter', () => uploadArea.classList.add('drag-over'));
                uploadArea.addEventListener('dragleave', () => uploadArea.classList.remove('drag-over'));
                uploadArea.addEventListener('drop', (e) => {
                    uploadArea.classList.remove('drag-over');
                    this.handleIdUpload({ target: { files: e.dataTransfer.files } });
                });

                // ë¹„ë°€ë²ˆí˜¸ ê°•ë„ ì²´í¬
                document.getElementById('password').addEventListener('input', () => this.checkPasswordStrength());

                // í¼ ì‹¤ì‹œê°„ ê²€ì¦
                this.bindFormValidation();
            },

            // ë‹¤ìŒ ë‹¨ê³„
            nextStep() {
                if (this.validateCurrentStep()) {
                    if (this.currentStep < this.maxStep) {
                        this.currentStep++;
                        this.updateStepDisplay();
                        this.updateFormData();
                    } else {
                        this.completeSignup();
                    }
                }
            },

            // ì´ì „ ë‹¨ê³„
            prevStep() {
                if (this.currentStep > 1) {
                    this.currentStep--;
                    this.updateStepDisplay();
                }
            },

            // ë‹¨ê³„ í‘œì‹œ ì—…ë°ì´íŠ¸
            updateStepDisplay() {
                // ì§„í–‰ ë‹¨ê³„ UI ì—…ë°ì´íŠ¸
                document.querySelectorAll('.progress-step').forEach((step, index) => {
                    step.classList.remove('current', 'completed');
                    if (index + 1 < this.currentStep) {
                        step.classList.add('completed');
                    } else if (index + 1 === this.currentStep) {
                        step.classList.add('current');
                    }
                });

                // ì»¨í…ì¸  í‘œì‹œ
                document.querySelectorAll('.step-content').forEach((content, index) => {
                    content.classList.remove('active');
                    if (index + 1 === this.currentStep) {
                        content.classList.add('active');
                    }
                });

                // ë²„íŠ¼ ìƒíƒœ
                const prevBtn = document.getElementById('prev-btn');
                const nextBtn = document.getElementById('next-btn');

                prevBtn.style.display = this.currentStep > 1 ? 'block' : 'none';
                nextBtn.textContent = this.currentStep === this.maxStep ? 'íšŒì›ê°€ì… ì™„ë£Œ' : 'ë‹¤ìŒ';

                // 2, 3ë‹¨ê³„ì—ì„œ ì—°ë½ì²˜ ì •ë³´ í‘œì‹œ
                if (this.currentStep === 2) {
                    document.getElementById('phone-display').textContent = this.formData.phone || '010-****-****';
                }
                if (this.currentStep === 3) {
                    document.getElementById('email-display').textContent = this.formData.email || 'example@email.com';
                }
            },

            // í˜„ì¬ ë‹¨ê³„ ê²€ì¦
            validateCurrentStep() {
                switch (this.currentStep) {
                    case 1:
                        return this.validateBasicInfo();
                    case 2:
                        return this.validateSmsVerification();
                    case 3:
                        return this.validateEmailVerification();
                    case 4:
                        return true; // ì‹ ë¶„ì¦ì€ ì„ íƒì‚¬í•­
                    default:
                        return false;
                }
            },

            // ê¸°ë³¸ì •ë³´ ê²€ì¦
            validateBasicInfo() {
                const form = document.getElementById('basic-info-form');
                const formData = new FormData(form);
                let isValid = true;

                // í•„ìˆ˜ í•„ë“œ ê²€ì‚¬
                const requiredFields = ['email', 'password', 'password-confirm', 'name', 'phone'];
                requiredFields.forEach(fieldId => {
                    const field = document.getElementById(fieldId);
                    if (!field.value.trim()) {
                        FormValidator.showError(fieldId, 'í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.');
                        isValid = false;
                    }
                });

                // ì´ë©”ì¼ ê²€ì¦
                const email = document.getElementById('email').value;
                if (email && !FormValidator.validateEmail(email)) {
                    FormValidator.showError('email', 'ì˜¬ë°”ë¥¸ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    isValid = false;
                }

                // ë¹„ë°€ë²ˆí˜¸ ê²€ì¦
                const password = document.getElementById('password').value;
                const passwordConfirm = document.getElementById('password-confirm').value;

                if (password && !FormValidator.validatePassword(password)) {
                    FormValidator.showError('password', 'ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒ, ì˜ë¬¸ê³¼ ìˆ«ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.');
                    isValid = false;
                }

                if (password !== passwordConfirm) {
                    FormValidator.showError('password-confirm', 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                    isValid = false;
                }

                // íœ´ëŒ€í° ë²ˆí˜¸ ê²€ì¦
                const phone = document.getElementById('phone').value;
                if (phone && !FormValidator.validatePhone(phone)) {
                    FormValidator.showError('phone', 'ì˜¬ë°”ë¥¸ íœ´ëŒ€í° ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”. (ì˜ˆ: 010-1234-5678)');
                    isValid = false;
                }

                // ì•½ê´€ ë™ì˜ ê²€ì¦
                if (!document.getElementById('terms-agree').checked) {
                    NotificationSystem.show('warning', 'ì•½ê´€ ë™ì˜ í•„ìš”', 'ì´ìš©ì•½ê´€ ë° ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨ì— ë™ì˜í•´ì£¼ì„¸ìš”.');
                    isValid = false;
                }

                return isValid;
            },

            // SMS ì¸ì¦ ê²€ì¦
            validateSmsVerification() {
                if (!this.verificationStatus.sms) {
                    NotificationSystem.show('warning', 'íœ´ëŒ€í° ì¸ì¦ í•„ìš”', 'íœ´ëŒ€í° ì¸ì¦ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”.');
                    return false;
                }
                return true;
            },

            // ì´ë©”ì¼ ì¸ì¦ ê²€ì¦
            validateEmailVerification() {
                if (!this.verificationStatus.email) {
                    NotificationSystem.show('warning', 'ì´ë©”ì¼ ì¸ì¦ í•„ìš”', 'ì´ë©”ì¼ ì¸ì¦ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”.');
                    return false;
                }
                return true;
            },

            // SMS ì¸ì¦ë²ˆí˜¸ ë°œì†¡
            sendSmsCode() {
                const btn = document.getElementById('send-sms-btn');
                LoadingManager.start(btn);

                // ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” API í˜¸ì¶œ
                setTimeout(() => {
                    LoadingManager.stop(btn);
                    this.startSmsTimer();
                    NotificationSystem.show('success', 'ì¸ì¦ë²ˆí˜¸ ë°œì†¡', 'íœ´ëŒ€í°ìœ¼ë¡œ ì¸ì¦ë²ˆí˜¸ê°€ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    btn.textContent = 'ì¬ë°œì†¡';
                }, 2000);
            },

            // SMS íƒ€ì´ë¨¸ ì‹œì‘
            startSmsTimer() {
                let timeLeft = 180; // 3ë¶„
                const timerElement = document.getElementById('sms-timer');

                const timer = setInterval(() => {
                    const minutes = Math.floor(timeLeft / 60);
                    const seconds = timeLeft % 60;
                    timerElement.textContent = `${minutes}:${seconds.toString().padStart(2, '0')} ë‚¨ìŒ`;

                    if (timeLeft <= 0) {
                        clearInterval(timer);
                        timerElement.textContent = 'ì¸ì¦ì‹œê°„ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì¬ë°œì†¡í•´ì£¼ì„¸ìš”.';
                    }
                    timeLeft--;
                }, 1000);
            },

            // SMS ì¸ì¦ë²ˆí˜¸ ê²€ì¦
            validateSmsCode() {
                const code = document.getElementById('sms-code').value;
                if (code.length === 6) {
                    // ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” API í˜¸ì¶œ
                    if (code === '123456') { // ì‹œë®¬ë ˆì´ì…˜
                        this.verificationStatus.sms = true;
                        NotificationSystem.show('success', 'ì¸ì¦ ì™„ë£Œ', 'íœ´ëŒ€í° ì¸ì¦ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
                        document.getElementById('sms-timer').textContent = 'âœ… ì¸ì¦ ì™„ë£Œ';
                        document.getElementById('sms-timer').style.color = 'var(--success)';
                    } else {
                        NotificationSystem.show('error', 'ì¸ì¦ ì‹¤íŒ¨', 'ì˜ëª»ëœ ì¸ì¦ë²ˆí˜¸ì…ë‹ˆë‹¤.');
                    }
                }
            },

            // ì´ë©”ì¼ ì¸ì¦ë²ˆí˜¸ ë°œì†¡
            sendEmailCode() {
                const btn = document.getElementById('send-email-btn');
                LoadingManager.start(btn);

                setTimeout(() => {
                    LoadingManager.stop(btn);
                    this.startEmailTimer();
                    NotificationSystem.show('success', 'ì¸ì¦ë²ˆí˜¸ ë°œì†¡', 'ì´ë©”ì¼ë¡œ ì¸ì¦ë²ˆí˜¸ê°€ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    btn.textContent = 'ì¬ë°œì†¡';
                }, 2000);
            },

            // ì´ë©”ì¼ íƒ€ì´ë¨¸ ì‹œì‘
            startEmailTimer() {
                let timeLeft = 300; // 5ë¶„
                const timerElement = document.getElementById('email-timer');

                const timer = setInterval(() => {
                    const minutes = Math.floor(timeLeft / 60);
                    const seconds = timeLeft % 60;
                    timerElement.textContent = `${minutes}:${seconds.toString().padStart(2, '0')} ë‚¨ìŒ`;

                    if (timeLeft <= 0) {
                        clearInterval(timer);
                        timerElement.textContent = 'ì¸ì¦ì‹œê°„ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì¬ë°œì†¡í•´ì£¼ì„¸ìš”.';
                    }
                    timeLeft--;
                }, 1000);
            },

            // ì´ë©”ì¼ ì¸ì¦ë²ˆí˜¸ ê²€ì¦
            validateEmailCode() {
                const code = document.getElementById('email-code').value;
                if (code.length === 6) {
                    // ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” API í˜¸ì¶œ
                    if (code === '654321') { // ì‹œë®¬ë ˆì´ì…˜
                        this.verificationStatus.email = true;
                        NotificationSystem.show('success', 'ì¸ì¦ ì™„ë£Œ', 'ì´ë©”ì¼ ì¸ì¦ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
                        document.getElementById('email-timer').textContent = 'âœ… ì¸ì¦ ì™„ë£Œ';
                        document.getElementById('email-timer').style.color = 'var(--success)';
                    } else {
                        NotificationSystem.show('error', 'ì¸ì¦ ì‹¤íŒ¨', 'ì˜ëª»ëœ ì¸ì¦ë²ˆí˜¸ì…ë‹ˆë‹¤.');
                    }
                }
            },

            // ì‹ ë¶„ì¦ ì—…ë¡œë“œ ì²˜ë¦¬
            handleIdUpload(event) {
                const file = event.target.files[0];
                if (file) {
                    if (file.size > 10 * 1024 * 1024) { // 10MB
                        NotificationSystem.show('error', 'íŒŒì¼ í¬ê¸° ì´ˆê³¼', 'íŒŒì¼ í¬ê¸°ëŠ” 10MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.');
                        return;
                    }

                    if (!file.type.startsWith('image/')) {
                        NotificationSystem.show('error', 'íŒŒì¼ í˜•ì‹ ì˜¤ë¥˜', 'ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                        return;
                    }

                    // ì—…ë¡œë“œ ì‹œë®¬ë ˆì´ì…˜
                    document.getElementById('id-upload').style.display = 'none';
                    document.getElementById('id-preview').style.display = 'block';
                    this.verificationStatus.idCard = true;

                    // ì•ˆì „ë„ ì ìˆ˜ ì—…ë°ì´íŠ¸
                    document.getElementById('predicted-score').textContent = '85';

                    NotificationSystem.show('success', 'ì—…ë¡œë“œ ì™„ë£Œ', 'ì‹ ë¶„ì¦ì´ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤. ê²€í†  í›„ ì¸ì¦ë©ë‹ˆë‹¤.');
                }
            },

            // ë¹„ë°€ë²ˆí˜¸ ê°•ë„ ì²´í¬
            checkPasswordStrength() {
                const password = document.getElementById('password').value;
                const strengthElement = document.getElementById('password-strength');
                const strengthText = document.getElementById('strength-text');

                let strength = 0;
                if (password.length >= 8) strength++;
                if (/[a-z]/.test(password)) strength++;
                if (/[A-Z]/.test(password)) strength++;
                if (/[0-9]/.test(password)) strength++;
                if (/[^A-Za-z0-9]/.test(password)) strength++;

                strengthElement.className = 'password-strength';
                if (strength < 2) {
                    strengthElement.classList.add('strength-weak');
                    strengthText.textContent = 'ì•½í•¨';
                } else if (strength < 4) {
                    strengthElement.classList.add('strength-medium');
                    strengthText.textContent = 'ë³´í†µ';
                } else {
                    strengthElement.classList.add('strength-strong');
                    strengthText.textContent = 'ê°•í•¨';
                }
            },

            // í¼ ë°ì´í„° ì—…ë°ì´íŠ¸
            updateFormData() {
                if (this.currentStep >= 2) {
                    this.formData.email = document.getElementById('email').value;
                    this.formData.name = document.getElementById('name').value;
                    this.formData.phone = document.getElementById('phone').value;
                }
            },

            // ì‹¤ì‹œê°„ í¼ ê²€ì¦ ë°”ì¸ë”©
            bindFormValidation() {
                // ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì‹¤ì‹œê°„ ì²´í¬
                document.getElementById('password-confirm').addEventListener('input', function() {
                    const password = document.getElementById('password').value;
                    const confirm = this.value;

                    if (confirm && password !== confirm) {
                        FormValidator.showError('password-confirm', 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                    } else {
                        FormValidator.clearError('password-confirm');
                    }
                });
            },

            // íšŒì›ê°€ì… ì™„ë£Œ
            completeSignup() {
                LoadingManager.start('#next-btn');

                // ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” API í˜¸ì¶œ
                setTimeout(() => {
                    // ì•ˆì „ë„ ì ìˆ˜ ê³„ì‚°
                    let safetyScore = 55; // ê¸°ë³¸ ì ìˆ˜
                    if (this.verificationStatus.sms) safetyScore += 10;
                    if (this.verificationStatus.email) safetyScore += 10;
                    if (this.verificationStatus.idCard) safetyScore += 15;

                    // ì‚¬ìš©ì ë°ì´í„° ì €ì¥
                    const userData = {
                        ...this.formData,
                        safetyScore,
                        verifications: this.verificationStatus,
                        signupDate: new Date().toISOString()
                    };

                    Storage.set('userData', userData);

                    NotificationSystem.show('success', 'íšŒì›ê°€ì… ì™„ë£Œ',
                        `í™˜ì˜í•©ë‹ˆë‹¤! ì•ˆì „ë„ ${safetyScore}ì ìœ¼ë¡œ ì‹œì‘í•©ë‹ˆë‹¤.`);

                    // ëŒ€ì‹œë³´ë“œë¡œ ì´ë™
                    setTimeout(() => {
                        window.location.href = '14-ë©”ì¸ëŒ€ì‹œë³´ë“œ.html';
                    }, 2000);
                }, 2000);
            }
        };

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            SignupManager.init();
        });
    </script>
</body>
</html>