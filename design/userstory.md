# 중고 거래 플랫폼 서비스 - 유저스토리

- [중고 거래 플랫폼 서비스 - 유저스토리](#중고-거래-플랫폼-서비스---유저스토리)
  - [마이크로서비스 구성](#마이크로서비스-구성)
  - [유저스토리](#유저스토리)
  - [기술 검토 결과](#기술-검토-결과)

---

## 마이크로서비스 구성
1. **User** - 사용자 인증 및 프로필 관리
2. **Safety** - 안전도 계산, 표시 생성 및 갱신 (핵심 서비스)
3. **Report** - 신고 접수, 검토 및 처리
4. **Monitor** - 위험 감지 및 실시간 대응
5. **Transaction** - 거래 이력 및 상품 관리

---

## 유저스토리

```
1. User 서비스
1) 사용자 인증 및 관리
UFR-USER-010: [안전회원가입] 중고거래 이용자로서 | 나는, 안전한 거래 환경 조성을 위해 | 신뢰할 수 있는 계정을 생성하고 싶다.
- 시나리오: 신뢰성 기반 회원가입
  중고거래 플랫폼에 접속한 상황에서 | 개인정보, 연락처 인증, 본인인증을 완료하면 | 기본 안전도 점수가 부여된 계정이 생성된다.

  [필수 인증 요구사항]
  - 휴대폰 번호 인증: SMS 인증번호 확인
  - 이메일 인증: 이메일 인증링크 확인
  - 신분증 인증: 주민등록증/운전면허증 (선택사항)

  [기본 안전도 점수 부여]
  - 휴대폰 인증 완료: +20점
  - 이메일 인증 완료: +10점
  - 신분증 인증 완료: +30점
  - 프로필 상세 작성: +10점
  - 기본 점수: 50점에서 시작

  [계정 생성 정책]
  - 동일 휴대폰 번호로 최대 1개 계정만 생성 가능
  - 신규 사용자는 7일간 "신규사용자" 배지 표시
  - 계정 생성 즉시 안전 표시 "회색 NEW" 배지 적용

- M/13

---

UFR-USER-020: [보안강화로그인] 중고거래 이용자로서 | 나는, 계정 보안 강화를 위해 | 다단계 인증이 포함된 로그인을 하고 싶다.
- 시나리오: 안전한 로그인 프로세스
  등록된 계정이 있는 상황에서 | ID/비밀번호와 추가 보안 인증을 완료하면 | 개인화된 안전 거래 환경에 접속할 수 있다.

  [보안 인증 단계]
  - 1단계: ID/비밀번호 입력
  - 2단계: SMS 인증 또는 이메일 인증 (선택)
  - 3단계: 의심 활동 감지 시 추가 본인 확인

  [로그인 보안 정책]
  - 5회 연속 실패 시 30분 계정 잠금
  - 새로운 기기/IP 로그인 시 SMS 인증 필수
  - 의심스러운 지역에서 접속 시 추가 인증

  [로그인 후 안전 정보 표시]
  - 내 현재 안전도 점수 표시
  - 최근 거래 이력 요약
  - 새로운 안전 정책 알림

- M/8

---

UFR-USER-030: [신뢰도프로필관리] 중고거래 이용자로서 | 나는, 거래 신뢰도 향상을 위해 | 상세한 프로필과 인증 정보를 관리하고 싶다.
- 시나리오: 신뢰도 향상을 위한 프로필 관리
  로그인한 상태에서 | 추가 인증 정보나 상세 프로필을 등록하면 | 안전도 점수가 향상되고 거래 신뢰성이 증가한다.

  [추가 인증 옵션]
  - 직장 인증: 재직증명서 업로드 (+20점)
  - 학교 인증: 학생증/졸업증명서 업로드 (+15점)
  - 거주지 인증: 주민등록등본 업로드 (+25점)
  - 소셜 미디어 연동: 페이스북/네이버 계정 연동 (+10점)

  [프로필 상세 정보]
  - 자기소개: 신뢰성 있는 소개글 작성
  - 거래 선호 방식: 직거래/택배거래 선호도
  - 주요 거래 지역: 직거래 가능 지역 설정
  - 거래 가능 시간: 연락 가능 시간대 설정

  [신뢰도 관리 기능]
  - 현재 안전도 점수 상세 내역 확인
  - 안전도 향상을 위한 권장 사항 제공
  - 거래 이력 기반 신뢰성 지표 표시

- S/8

---

2. Safety 서비스
1) 안전도 관리
UFR-SAFE-010: [안전도조회] 구매자로서 | 나는, 거래 위험을 사전에 판단하기 위해 | 판매자의 안전도를 직관적으로 확인하고 싶다.
- 시나리오: 판매자 안전도 확인
  상품 상세 페이지에서 | 판매자 정보 영역을 확인하면 | 색상과 별점으로 표시된 안전도 정보와 상세 내역을 확인할 수 있다.

  [안전도 시각적 표시]
  - 최우수(90-100점): 진녹색 + ★★★★★ + "최우수 판매자" 배지
  - 우수(70-89점): 녹색 + ★★★★☆ + "우수 판매자" 배지
  - 보통(50-69점): 주황색 + ★★★☆☆ + "일반 판매자" 배지
  - 주의(30-49점): 빨간색 + ★★☆☆☆ + "주의 필요" 경고
  - 위험(0-29점): 검은색 + ★☆☆☆☆ + "거래 위험" 경고
  - 신규(7일 미만): 회색 + ⭐NEW + "신규 사용자" 배지

  [상세 안전 정보]
  - 거래 완료율: 전체 거래 대비 성공적 완료 비율
  - 평균 응답 시간: 구매 문의에 대한 평균 응답 시간
  - 신고 접수 현황: 최근 3개월 신고 접수 건수
  - 계정 생성일: 플랫폼 가입 기간
  - 인증 배지: 완료된 인증 항목들

  [취약계층 보호 정보]
  - 여성/노약자 친화 판매자 여부
  - 안전한 거래 장소 제공 가능 여부
  - 낮 시간대 거래 가능 여부

- M/21

---

UFR-SAFE-020: [안전도계산] 시스템으로서 | 나는, 정확한 신뢰도 평가를 위해 | 다양한 요소를 종합하여 사용자 안전도를 계산하고 싶다.
- 시나리오: 종합적 안전도 점수 계산
  사용자의 활동 데이터가 업데이트된 상황에서 | 거래이력, 신고내역, 계정정보를 분석하면 | 정확한 안전도 점수가 계산되어 등급이 결정된다.

  [안전도 계산 요소]
  - 거래 완료율: 70% 이상 +20점, 50% 미만 -20점
  - 신고 접수: 3건 이상 -30점, 사기 신고 -50점
  - 계정 생성일: 30일 미만 신규 표시, 1년 이상 +10점
  - 거래 취소율: 50% 이상 -20점
  - 평균 응답시간: 24시간 이상 -10점, 1시간 이내 +10점
  - 프로필 완성도: 90% 이상 +10점
  - 추가 인증: 인증 항목당 +10~30점

  [위험 요소 감지]
  - 동일 IP 24시간 내 5개 이상 계정 생성 -50점
  - 거래 패턴 급격한 변화 -30점
  - 신고 접수 급증 -40점
  - 비정상적 가격 설정 패턴 -20점

  [계산 주기 및 정책]
  - 실시간 계산: 거래 완료, 신고 접수 시 즉시 반영
  - 일간 갱신: 매일 자정 활성 사용자 대상
  - 주간 갱신: 매주 일요일 전체 사용자 대상
  - 긴급 갱신: 위험 감지 시 즉시 재계산

- M/34

---

UFR-SAFE-030: [안전표시생성] 시스템으로서 | 나는, 사용자의 쉬운 이해를 위해 | 계산된 안전도를 직관적인 시각 요소로 생성하고 싶다.
- 시나리오: 시각적 안전 표시 생성
  안전도 점수가 계산 완료된 상황에서 | 사용자 설정과 테마를 고려하여 | 색상, 아이콘, 배지가 포함된 시각 표시가 생성된다.

  [사용자 맞춤 설정]
  - 색약 사용자: 대체 색상 패턴 제공
  - 고령자: 큰 아이콘과 명확한 텍스트
  - 시각 장애인: 텍스트 대체 설명 포함
  - 간단/상세 모드: 표시 정보량 선택

  [표시 요소 구성]
  - 기본 색상: 등급별 색상 배경
  - 별점 표시: 1~5개 별 또는 NEW 배지
  - 텍스트 라벨: "최우수", "우수", "주의" 등
  - 상세 정보: 호버 시 추가 정보 표시

  [캐싱 및 업데이트 정책]
  - 일반 사용자: 1시간 캐시
  - 신규 사용자: 실시간 갱신
  - 위험 사용자: 30분 캐시
  - 등급 변경 시: 즉시 업데이트 및 알림

- S/13

---

UFR-SAFE-040: [안전도갱신] 시스템으로서 | 나는, 최신 신뢰도 유지를 위해 | 주기적 또는 이벤트 기반으로 안전도를 갱신하고 싶다.
- 시나리오: 시스템 안전도 갱신
  갱신 스케줄이 도래하거나 특정 이벤트가 발생한 상황에서 | 대상 사용자들의 최신 데이터를 분석하면 | 업데이트된 안전도와 표시가 반영된다.

  [갱신 트리거]
  - 주기적 갱신: 일간/주간/월간 스케줄
  - 이벤트 갱신: 거래 완료, 신고 접수, 위험 감지
  - 정책 갱신: 안전도 계산 규칙 변경
  - 대량 갱신: 시스템 정책 업데이트

  [배치 처리 최적화]
  - 시스템 부하 < 70%: 대용량 배치
  - 시스템 부하 70-85%: 중간 배치
  - 시스템 부하 > 85%: 소용량 배치
  - 피크 시간대: 처리 연기

  [갱신 결과 처리]
  - 등급 변경 알림: 2단계 이상 변경 시 사용자 알림
  - 위험 등급 전환: 즉시 관리자 알림
  - 갱신 통계: 관리자 대시보드 업데이트

- S/21

---

3. Report 서비스
1) 신고 처리
UFR-REPO-010: [신고접수] 거래참여자로서 | 나는, 부적절한 행위 신고를 위해 | 구체적이고 체계적인 신고를 접수하고 싶다.
- 시나리오: 사용자 신고 접수
  거래 과정에서 문제가 발생한 상황에서 | 신고 유형을 선택하고 증거자료를 첨부하면 | 신고가 접수되고 처리 번호가 발급된다.

  [신고 유형 분류]
  - 사기 의심: 허위 상품, 대금 미지급, 연락 두절
  - 불량 상품: 상품 상태 허위 기재, 품질 문제
  - 욕설/폭언: 부적절한 언어 사용, 협박
  - 연락 두절: 약속 장소 미출현, 연락 불응
  - 기타: 플랫폼 정책 위반 행위

  [증거 자료 제출]
  - 채팅 내용: 대화 스크린샷
  - 거래 내역: 결제 증명, 계좌 이체 내역
  - 상품 사진: 실제 상품과 차이점 증명
  - 녹음 파일: 통화 내용 (법적 허용 범위)

  [신고 처리 정책]
  - 긴급 처리: 사기, 협박 등 즉시 검토
  - 일반 처리: 3영업일 내 검토 완료
  - 중복 신고: 기존 사건과 연결 처리
  - 허위 신고: 신고자 경고 조치

- M/13

---

UFR-REPO-020: [신고검토처리] 관리자로서 | 나는, 공정한 분쟁 해결을 위해 | 신고 내용을 체계적으로 검토하고 적절한 조치를 하고 싶다.
- 시나리오: 신고 검토 및 조치
  신고가 접수된 상황에서 | 증거자료와 관련 정보를 종합 검토하면 | 사실 확인 결과에 따른 적절한 조치가 실행된다.

  [검토 프로세스]
  - 1단계: 신고 내용 및 증거 자료 검토
  - 2단계: 피신고자 과거 이력 조회
  - 3단계: 관련 거래 정보 확인
  - 4단계: 양 당사자 진술 청취
  - 5단계: 종합 판정 및 조치 결정

  [조치 유형]
  - 사실 확인: 제재 조치 + 안전도 차감
    - 사기 확인: 계정 정지 + 안전도 -50점
    - 불량 상품: 경고 + 안전도 -20점
    - 욕설/폭언: 경고 + 안전도 -15점
  - 사실 확인 어려움: 모니터링 강화
  - 거짓 신고: 신고자 경고
  - 악의적 신고: 신고자 제재

  [사후 관리]
  - 처리 결과 양 당사자 통보
  - 안전도 재계산 및 표시 업데이트
  - 유사 사건 재발 방지 모니터링

- M/21

---

4. Monitor 서비스
1) 위험 감지 및 대응
UFR-MONI-010: [위험감지] 시스템으로서 | 나는, 사기 예방을 위해 | 의심스러운 활동 패턴을 실시간으로 감지하고 싶다.
- 시나리오: 실시간 위험 패턴 감지
  사용자 활동 데이터가 수집되는 상황에서 | 기정의된 위험 규칙과 패턴을 분석하면 | 의심 활동이 감지되어 위험도가 평가된다.

  [위험 감지 규칙]
  - 계정 생성 패턴: 동일 IP 24시간 내 5개 이상 계정
  - 거래 패턴 이상: 취소율 급격 증가(50% 이상)
  - 응답 패턴 이상: 평균 응답시간 급격 지연(24시간 이상)
  - 결제 패턴 이상: 동일 결제수단 다중 계정 사용
  - 가격 패턴 이상: 시세 대비 비정상적 가격 설정

  [위험도 평가]
  - 낮음(1-3점): 모니터링 강화
  - 보통(4-6점): 제한적 조치 검토
  - 높음(7-8점): 즉시 조치 필요
  - 매우높음(9-10점): 계정 임시 정지

  [감지 시점 및 범위]
  - 실시간 감지: 계정 생성, 거래 등록, 메시지 발송
  - 배치 분석: 매시간 패턴 분석
  - 연관 계정: 의심 계정과 연결된 계정 추가 분석

- M/34

---

UFR-MONI-020: [위험대응] 관리자로서 | 나는, 신속한 피해 방지를 위해 | 감지된 위험에 즉시 대응하고 관련 조치를 하고 싶다.
- 시나리오: 위험 상황 즉시 대응
  위험 요소가 감지된 상황에서 | 위험도 수준에 따른 자동/수동 조치를 실행하면 | 추가 피해가 방지되고 관련 계정이 보호된다.

  [자동 대응 조치]
  - 매우높은 위험(9-10점): 계정 즉시 정지
  - 높은 위험(7-8점): 거래 기능 제한
  - 보통 위험(4-6점): 모니터링 강화
  - 낮은 위험(1-3점): 로그 기록 및 추적

  [수동 검토 프로세스]
  - 관리자 알림: 위험도 7점 이상 즉시 알림
  - 긴급 대응팀: 사기 의심 시 24시간 대응
  - 증거 수집: 관련 로그 및 활동 기록 보전
  - 연관 조사: 동일 IP, 결제수단 등 연관 계정 조사

  [피해 방지 조치]
  - 거래 중단: 진행 중인 거래 일시 중단
  - 자금 보호: 에스크로 자금 보호 조치
  - 사용자 알림: 관련 거래 상대방에게 주의 알림
  - 재발 방지: 유사 패턴 감지 규칙 강화

- M/21

---

5. Transaction 서비스
1) 거래 이력 관리
UFR-TRAN-010: [거래등록] 판매자로서 | 나는, 투명한 거래를 위해 | 상품 정보를 상세하고 정확하게 등록하고 싶다.
- 시나리오: 신뢰성 있는 상품 등록
  상품 판매를 위해 등록 페이지에 접근한 상황에서 | 상품 정보, 사진, 거래 조건을 입력하면 | 검증을 거쳐 신뢰성 있는 거래 게시물이 생성된다.

  [필수 등록 정보]
  - 상품 기본정보: 제품명, 브랜드, 모델명, 구매 시기
  - 상품 상태: 신품/중고(상/중/하), 사용 기간, 특이사항
  - 가격 정보: 판매가, 원래 구매가, 네고 가능 여부
  - 거래 방식: 직거래/택배, 직거래 가능 지역
  - 상품 사진: 최소 3장, 실제 상품 전체/부분/하자 부분

  [신뢰도 향상 정보]
  - 구매 영수증: 정품 인증 및 구매 시기 증명
  - 보증서/설명서: 제품 관련 서류 첨부
  - 시세 정보: 현재 시장 가격 대비 적정성
  - 판매 이유: 구체적이고 합리적인 판매 사유

  [자동 검증 시스템]
  - 가격 적정성: 시장 가격 대비 +/-30% 초과 시 경고
  - 사진 품질: 흐림, 워터마크 등 부적절한 사진 감지
  - 텍스트 검증: 욕설, 허위 정보, 과장 광고 문구 필터링
  - 중복 등록: 동일 상품 중복 등록 방지

- M/13

---

UFR-TRAN-020: [거래이력관리] 거래참여자로서 | 나는, 신뢰도 축적을 위해 | 거래 과정과 결과를 체계적으로 기록하고 관리하고 싶다.
- 시나리오: 투명한 거래 이력 관리
  거래가 진행되는 상황에서 | 각 단계별 상태와 결과를 기록하면 | 신뢰성 있는 거래 이력이 축적되어 안전도에 반영된다.

  [거래 단계별 기록]
  - 관심 표시: 찜, 문의 시작 시간
  - 협상 과정: 가격/조건 협상 내역, 최종 합의 내용
  - 거래 약속: 만남 장소/시간, 거래 방식 확정
  - 거래 완료: 상품 확인, 대금 지급, 거래 완료 확인
  - 후기 작성: 상호 평가 및 후기 작성

  [거래 품질 지표]
  - 응답 속도: 문의에 대한 평균 응답 시간
  - 약속 이행: 정해진 시간/장소 준수 여부
  - 상품 상태: 설명과 실제 상품 일치도
  - 거래 태도: 예의, 친절함, 전문성
  - 사후 관리: 문제 발생 시 해결 태도

  [안전도 반영 규칙]
  - 거래 완료율 70% 이상: +20점
  - 평균 응답시간 1시간 이내: +10점
  - 약속 시간 준수율 90% 이상: +15점
  - 상품 설명 일치도 95% 이상: +10점
  - 긍정적 후기 비율 80% 이상: +15점

  [이력 투명성 보장]
  - 거래 상대방 상호 확인 및 동의
  - 허위 이력 방지를 위한 교차 검증
  - 민감 정보 보호를 위한 익명화 처리

- M/21

---
```

## 기술 검토 결과

**[마이크로서비스별 검토]**

1) **User 서비스**
모든 유저스토리 **✅ 실현 가능**
- 표준적인 인증/인가 패턴
- JWT 토큰, Redis 캐싱 등 검증된 기술 활용
- 다단계 인증 구현 가능

2) **Safety 서비스**
대부분 **✅ 실현 가능**, 일부 주의 필요

**주요 검토 사항:**
- UFR-SAFE-020: **⚠️ 복잡한 안전도 계산 로직**
  - 다양한 요소의 가중치 조정 필요
  - 실시간 계산과 배치 처리의 균형
  - 성능 최적화 고려 필요
- UFR-SAFE-040: **⚠️ 대용량 배치 처리**
  - 시스템 부하 고려한 배치 크기 조정
  - 실시간 갱신과 주기적 갱신의 효율적 조합

3) **Report 서비스**
**✅ 실현 가능**
- 신고 접수 및 처리 워크플로우는 표준적 패턴
- 증거 자료 관리를 위한 파일 시스템 필요
- 관리자 대시보드 및 알림 시스템 구축

4) **Monitor 서비스**
**⚠️ 높은 기술적 복잡도**

- UFR-MONI-010: **주요 도전 과제**
  - 실시간 패턴 분석 엔진 구축
  - 복잡한 위험 감지 규칙 관리
  - 대용량 로그 데이터 처리
  - **해결방안**: 스트림 처리, 머신러닝 활용, 캐싱 최적화

5) **Transaction 서비스**
대부분 **✅ 실현 가능**

- UFR-TRAN-010: **⚠️ 자동 검증 시스템**
  - 이미지 품질 검사 및 텍스트 필터링
  - 시장 가격 정보 연동 필요
  - AI 기반 콘텐츠 검증 고려

**[주요 기술 스택 권장사항]**

**백엔드:**
- Node.js/Express 또는 Spring Boot (마이크로서비스)
- Redis (캐싱, 세션, 실시간 데이터)
- PostgreSQL (거래 데이터, 사용자 정보)
- MongoDB (로그 데이터, 비정형 데이터)
- RabbitMQ (비동기 메시지 처리)
- Elasticsearch (로그 분석, 검색)

**프론트엔드:**
- React/Next.js (사용자 인터페이스)
- TypeScript (타입 안정성)
- Redux/Zustand (상태 관리)
- Socket.io (실시간 알림)

**인프라:**
- Docker/Kubernetes (컨테이너 오케스트레이션)
- Nginx (로드 밸런서, API Gateway)
- Prometheus/Grafana (모니터링)
- ELK Stack (로그 관리)

**[주요 기술적 리스크 및 해결방안]**

**1. 실시간 위험 감지 성능**
- 리스크: 대용량 실시간 데이터 처리 부하
- 해결방안:
  - Apache Kafka를 활용한 스트림 처리
  - Redis를 활용한 실시간 캐싱
  - 규칙 기반 엔진과 머신러닝 하이브리드

**2. 안전도 계산 복잡성**
- 리스크: 다양한 요소의 가중치 조정 및 성능
- 해결방안:
  - 계산 로직의 모듈화
  - 배치 처리와 실시간 처리 분리
  - 계산 결과 캐싱 전략

**3. 확장성 및 가용성**
- 리스크: 사용자 증가에 따른 시스템 부하
- 해결방안:
  - 마이크로서비스 아키텍처 채택
  - 데이터베이스 샤딩
  - CDN 활용한 정적 자원 분산

**4. 데이터 보안 및 프라이버시**
- 리스크: 개인정보 및 거래 정보 보호
- 해결방안:
  - 암호화 저장 및 전송
  - 접근 권한 관리 강화
  - 개인정보 익명화 처리

**[개발 우선순위 권장사항]**

**Phase 1 (MVP):**
- User 서비스 (회원가입, 로그인, 기본 프로필)
- Safety 서비스 (기본 안전도 계산 및 표시)
- Transaction 서비스 (기본 거래 등록 및 이력)

**Phase 2 (핵심 기능):**
- Report 서비스 (신고 접수 및 처리)
- Safety 서비스 고도화 (복잡한 계산 로직)

**Phase 3 (고급 기능):**
- Monitor 서비스 (실시간 위험 감지)
- 인공지능 기반 패턴 분석